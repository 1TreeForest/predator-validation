var bannerEditor;bannerEditor=(()=>{"use strict";var n={900:(n,o,e)=>{function t(n,o){var e=$.extend({heading:"",className:"",top:200,buttons:[],draggable:!0,aroundArea:!1,position:"absolute",close:"remove",beforeRemove:function(){return!0}},o),t=$("body"),a=$('<div class="popup-draggable '.concat(e.className,'"></div>'));t.append(a);var i=$('<div class="around-pop-up"></div>');e.aroundArea&&t.append(i);var r=$('<div class="pop-up-close"></div>');if(a.append(r),e.heading){var c=$('<div class="popup-heading"></div>');c.append(e.heading),a.append(c)}var d=$('<div class="popup-content pop-mess-cont"></div>');if(d.append(n),a.append(d),e.buttons&&e.buttons.length>0){var s=$('<div class="popup-buttons"></div>');e.buttons.forEach((function(n){s.append(n)})),a.append(s)}function u(){e.beforeRemove(),"remove"===e.remove?(a.remove(),i.remove()):(a.hide(),i.hide())}a.css({left:($(window).width()-a.width())/2,top:$(window).scrollTop()+e.top}),"fixed"===e.position&&a.css({top:e.top,position:"fixed"}),r.on("click",u),i.on("click",u),a.on("close",u),a.on("open",(function(){a.show(),i.show()}));var v={};return $(".popup-heading",a).length&&(v={handle:".popup-heading"}),e.draggable&&a.draggable(v),a}function a(n){if(!window.bannerEditor)return!1;var o=window.bannerEditor.data=n;o.jObjects={svgEditorIframe:$(".svg-editor-iframe"),saveButton:$(".btn-save-boxes"),backButton:$(".btm-back")},r(),$(window).on("resize",r),o.editorPromise=new Promise((function(n,e){document.getElementById("svg_editor_frame").onload=function(){for(var t,a=0;a<10;a++)if("svg_editor_frame"===window.frames[a].frameElement.id){t=window.frames[a];break}t||e("SVG Editor hasn't loaded"),o.frame=t,o.svgEditor=t.svgEditor.svgEditor,n(t.svgEditor.svgEditor)}})),function(){var n=window.bannerEditor.data;n.editorPromise.then((function(o){o.bannerUploaded=new Promise((function(e){$.get("banner_manager/get-svg",{banners_id:n.banners_id,language_id:n.language_id,banner_group:n.banner_group},(function(n){o.loadFromString(n),e()}))}))})).catch((function(n){console.error(new Error(n))}))}(),function(){var n=window.bannerEditor.data,o=n.tr;n.editorPromise.then((function(e){n.jObjects.backButton.on("click",(function(){var a="banner_manager/banneredit?banners_id=".concat(n.banners_id,"&language_id=").concat(n.language_id);if(n.undoStackSize||(n.undoStackSize=1),e.canvas.undoMgr.getUndoStackSize()!==n.undoStackSize){var i=$('<span class="btn btn-save">'.concat(o.IMAGE_SAVE,"</span>")),r=$('<span class="btn btn-save">'.concat(o.NOT_SAVE,"</span>")),d=$('<span class="btn btn-cancel">'.concat(o.IMAGE_CANCEL,"</span>")),s=t($("<div>".concat(o.YOU_CHANGED_BANNER,"</div>")),{heading:o.GO_TO_BANNER_PAGE,buttons:[i,d,r]});i.on("click",(function(){c(),window.location=a})),r.on("click",(function(){window.location=a})),d.on("click",(function(){s.remove()}))}else window.location=a}))})).catch((function(n){console.error(new Error(n))}))}(),function(){var n=window.bannerEditor.data;n.editorPromise.then((function(){n.jObjects.saveButton.on("click",c)})).catch((function(n){console.error(new Error(n))}))}()}function i(n){if(!window.bannerEditor)return!1;var o=window.bannerEditor.data=n,e=o.tr,a=!1,i=$("#save_banner_form");i.on("change",(function(){a=!0})),$("body").on("click",".btn-remove-svg",(function(){$(this).closest("td").find("svg").remove(),$(this).closest("td").find(".group-svg-remove").val(1)})),$("body").on("click",".btn-edit-svg",(function(){var n=$(this).data("href");if(a){var o=$('<span class="btn btn-save">'.concat(e.IMAGE_SAVE,"</span>")),r=$('<span class="btn btn-save">'.concat(e.NOT_SAVE,"</span>")),c=$('<span class="btn btn-cancel">'.concat(e.IMAGE_CANCEL,"</span>")),d=t($("<div>".concat(e.CHANGED_DATA_ON_PAGE,"</div>")),{heading:e.GO_TO_BANNER_EDITOR,buttons:[o,c,r]});o.on("click",(function(){$.post(i.attr("action"),i.serialize(),(function(o,e){"success"===e?window.location=n:alert("Request error.")}),"html")})),r.on("click",(function(){window.location=n})),c.on("click",(function(){d.remove()}))}else window.location=n})),o.setLanguage&&($('.nav a[href="#tab_2"]').trigger("click"),$('.nav a[data-id="'.concat(o.setLanguage,'"]')).trigger("click"))}function r(){var n=window.bannerEditor.data.jObjects,o=$(window).height()-200;n.svgEditorIframe.css({height:o})}function c(){var n=window.bannerEditor.data;if(!n.svgEditor)return!1;var o=n.svgEditor.canvas.getSvgString();o=o.replace(/width="([.0-9]+)" height="([.0-9]+)"/,'viewBox="0 0 $1 $2"'),n.undoStackSize=n.svgEditor.canvas.undoMgr.getUndoStackSize(),$.post("banner_manager/save-svg",{banners_id:n.banners_id,language_id:n.language_id,banner_group:n.banner_group,svg:o},(function(n){var o=t('<div class="alert-message">'.concat(n,"</div>"));setTimeout((function(){o.remove()}),1e3)}))}e.r(o),e.d(o,{bannerEdit:()=>i,init:()=>a})}},o={};function e(t){if(o[t])return o[t].exports;var a=o[t]={exports:{}};return n[t](a,a.exports,e),a.exports}return e.d=(n,o)=>{for(var t in o)e.o(o,t)&&!e.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:o[t]})},e.o=(n,o)=>Object.prototype.hasOwnProperty.call(n,o),e.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e(900)})();